npm warn Unknown env config "http-proxy". This will stop working in the next major version of npm.

> treasure-engine@1.0.0 verify:treasure
> node scripts/profit/__tests__/treasure_engine.test.mjs && node -e "if(process.env.CI==='true'&&process.env.FREEZE_REGRESSION!=='0'){process.exit(require('child_process').spawnSync('npm',['run','verify:epochs:freeze'],{stdio:'inherit'}).status??1)}"

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TREASURE ENGINE PROFIT SYSTEM TESTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â” PROFIT/LOSS CALCULATION â”â”â”
âœ“ LONG gross PnL correct
âœ“ Fees/slippage reduce net PnL
âœ“ LONG trade is profitable
âœ“ SHORT gross PnL correct
âœ“ SHORT trade is profitable
âœ“ Losing trade identified

â”â”â” BREAK-EVEN CALCULATION â”â”â”
âœ“ Break-even price above entry
âœ“ Break-even price reasonable

â”â”â” TARGET EXIT CALCULATION â”â”â”
âœ“ Target exit accounts for ROI + costs
âœ“ Target exit reasonable

â”â”â” POSITION SIZING â”â”â”
âœ“ Risk amount is 1% of capital
âœ“ Price distance to stop correct
âœ“ Position size correct (100 / 2)

â”â”â” RISK/REWARD RATIO â”â”â”
âœ“ Reward distance correct
âœ“ Risk distance correct
âœ“ RR ratio correct (3:1)
âœ“ RR ratio acceptable (>=2:1)

â”â”â” FEE CONFIGURATION â”â”â”
âœ“ Custom maker fee set
âœ“ Custom taker fee set
âœ“ Custom slippage set

â”â”â” OPPORTUNITY DETECTOR INIT â”â”â”
âœ“ Min score configured
âœ“ Min profit configured
âœ“ Price history starts empty

â”â”â” PRICE HISTORY MANAGEMENT â”â”â”
âœ“ History trimmed to max size
âœ“ Oldest prices removed

â”â”â” OPPORTUNITY SCORING â”â”â”
âœ“ Excellent opportunity scores high
âœ“ Poor opportunity scores low

â”â”â” DETECTOR STATISTICS â”â”â”
âœ“ Stats include total detected
âœ“ Stats include recent count
âœ“ Stats include history size

â”â”â” OPPORTUNITY TYPES â”â”â”
âœ“ PRICE_SPIKE type exists
âœ“ VOLATILITY type exists
âœ“ TREND_REVERSAL type exists
âœ“ BREAKOUT type exists

â”â”â” EDGE CASES â”â”â”
âœ“ Throws on invalid side
âœ“ Throws on invalid stop loss
âœ“ No fees/slippage = gross equals net

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
RESULTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ“ PASSED: 37
âœ— FAILED: 0
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ All treasure engine tests passed

ðŸ’° TREASURE ENGINE CAPABILITIES VERIFIED:
   âœ“ Profit/loss calculations (with fees/slippage)
   âœ“ Risk/reward analysis
   âœ“ Position sizing
   âœ“ Break-even calculations
   âœ“ Opportunity detection
   âœ“ Opportunity scoring

npm warn Unknown env config "http-proxy". This will stop working in the next major version of npm.

> treasure-engine@1.0.0 verify:epochs:freeze
> node scripts/verify/epoch_freeze_regression.mjs

pack:verify PASSED for EPOCH-41
PASS verify:epoch41 evidence=.tmp/epoch_freeze/EPOCH-41
freeze PASS EPOCH-41
pack:verify PASSED for EPOCH-42
âœ“ fill loader returns explicit fallback marker
âœ“ fallback reason is explicit when fill file missing
âœ“ fill contract rejects non-finite numbers
âœ“ calibration params deterministic for same inputs
âœ“ calibration fingerprints deterministic for same inputs
âœ“ bucket classified as HIGH
âœ“ HIGH fill_ratio in [0,1]
âœ“ HIGH notional conservation invariant
âœ“ bucket classified as MID
âœ“ MID fill_ratio in [0,1]
âœ“ MID notional conservation invariant
âœ“ bucket classified as LOW
âœ“ LOW fill_ratio in [0,1]
âœ“ LOW notional conservation invariant
âœ“ bucket classified as MICRO
âœ“ MICRO fill_ratio in [0,1]
âœ“ MICRO notional conservation invariant
âœ“ partial-fill severity monotonic by liquidity bucket
âœ“ freshness action ALLOW for HFT
âœ“ freshness action BLOCK for HFT
âœ“ freshness action DOWNWEIGHT for SWING
âœ“ stale HFT signal blocked in signal->intent path
âœ“ swing stale signal downweighted
âœ“ signal->intent freshness path deterministic
PASS verify:epoch42 checks=24 fingerprint=ea5d7a4a427c61664d774e2a86e77c831468122154f6305e323b1e6b7d301ebf
freeze PASS EPOCH-42
pack:verify PASSED for EPOCH-43
âœ“ input fingerprint stable x2
âœ“ output fingerprint stable x2
âœ“ split count equals k
âœ“ all splits have non-empty train/test
âœ“ train/test leakage absent by index
âœ“ PBO in [0,1]
âœ“ DSR finite
PASS verify:epoch43 checks=7 fingerprint=9023606b3e2ce243294c6879ed0fbae7ecbb1ba34e1af6e6fb133d37c094ac8f
freeze PASS EPOCH-43
pack:verify PASSED for EPOCH-44
âœ“ crisis deterministic x2
âœ“ sizing degrades as drawdown worsens
âœ“ hard stop cannot be bypassed
âœ“ normal path keeps sizing > 0
PASS verify:epoch44 checks=4 fp=fc341196baaa21e08ffd5b7159088bfd787d753ea375857329ecbd3857da9cc4
freeze PASS EPOCH-44
pack:verify PASSED for EPOCH-45
âœ“ deterministic outputs x2
âœ“ replay from event log matches output
âœ“ all events carry seed
âœ“ policy: no risk FSM bypass
âœ“ policy: network remains disabled by default
PASS verify:epoch45 checks=5 fp=8292ff98ee4c7e767be6d1d69aa87444b8fbf39402320555bb3dfac561b6ca25
freeze PASS EPOCH-45
pack:verify PASSED for EPOCH-46
âœ“ deterministic replay x2
âœ“ expected fixture row count
âœ“ contract validation passes for all candles
âœ“ no look-ahead ordering drift
âœ“ dedup check passes
PASS verify:epoch46 checks=5 fp=d66bf3c3874fad91c32b359cea32097a7e9a6a35998a3de0c3fd31e2d2c70f6f
freeze PASS EPOCH-46
pack:verify PASSED for EPOCH-47
freeze SKIP EPOCH-47 (no verifier + no mutable paths)
pack:verify PASSED for EPOCH-48
freeze SKIP EPOCH-48 (no verifier + no mutable paths)
pack:verify PASSED for EPOCH-49
âœ“ manifest exists
âœ“ raw chunk exists
âœ“ normalized chunk exists
âœ“ SHA256SUMS.DATA exists
âœ“ manifest chunk list complete
âœ“ SHA256SUMS.DATA contains normalized chunk hash
âœ“ deterministic replay fingerprint stable
âœ“ dedup detected in fixture
âœ“ gap detected in fixture
âœ“ out-of-order detected in fixture
PASS verify:epoch49 checks=10
freeze PASS EPOCH-49
pack:verify PASSED for EPOCH-50
âœ“ strict ingest succeeds for fixture with fill_id
âœ“ fills dataset manifest exists
âœ“ private quality report exists
âœ“ fixture calibration runs in REAL mode
âœ“ calibration deterministic fingerprint stable
âœ“ strict calibration succeeds on valid fixture
âœ“ strict-mode negative test fails when fill_id missing (expected fail)
PASS verify:epoch50 checks=7
freeze PASS EPOCH-50
pack:verify PASSED for EPOCH-51
âœ“ rechunk ingest variants succeed
âœ“ rechunk dataset fingerprint invariant
âœ“ rechunk calibration manifest invariant
âœ“ paper session deterministic x2
âœ“ risk fortress hard stop triggered in fixture session
âœ“ paper fills produced
âœ“ strict expected-fail on missing REAL fills dataset
PASS verify:epoch51 checks=7
freeze PASS EPOCH-51
pack:verify PASSED for EPOCH-52
âœ“ SHADOW mode produces state log
âœ“ SHADOW mode has no submission plan
âœ“ PAPER mode produces paper pnl metric
âœ“ PAPER mode has no submission plan
âœ“ GUARDED_LIVE mode produces submission plan
âœ“ GUARDED_LIVE never submits actions
âœ“ determinism x2 fingerprint invariant
âœ“ auto-pause triggers on injected crisis scenario
âœ“ strict mode expected-fail when overfit metrics missing
PASS verify:epoch52 checks=9
freeze PASS EPOCH-52
pack:verify PASSED for EPOCH-53
âœ“ reason codes taxonomy exists
âœ“ pause events include reason codes + metrics
âœ“ risk events include reason codes + transitions
âœ“ thresholds_used is complete
âœ“ determinism x2 identical fingerprints
âœ“ fitness suite output generated
PASS verify:epoch53 checks=6
freeze PASS EPOCH-53
pack:verify PASSED for EPOCH-54
âœ“ rechunk fingerprint invariant under chunk boundaries
âœ“ strict dedup removes duplicate trade_id rows
âœ“ heuristic dedup flagged when trade_id absent
âœ“ strict mode fails when heuristic dedup would be required
PASS verify:epoch54 checks=4
freeze PASS EPOCH-54
pack:verify PASSED for EPOCH-55
âœ“ frontier report generated with bounded grid and top-k
âœ“ determinism x2 frontier fingerprint invariant
âœ“ frontier entries include params + metrics
PASS verify:epoch55 checks=3
freeze PASS EPOCH-55
pack:verify PASSED for EPOCH-56
âœ“ fitness v2 non-constant across scenarios
âœ“ fitness v2 emits required per-scenario metrics
âœ“ vault policy strict expected-fail enforced for tuning sweep
âœ“ pause-recover deterministic x2 fingerprint invariant
âœ“ pause-recover transition trace generated
âœ“ hard stop remains enforced during recovery
âœ“ recovery flow does not submit any action
PASS verify:epoch56 checks=7
freeze PASS EPOCH-56
pack:verify PASSED for EPOCH-57
freeze SKIP EPOCH-57 (no verifier + no mutable paths)
pack:verify FAILED
- gate run hash mismatch: gates/verify_treasure_run1.log
- SHA256SUMS mismatch for gates/verify_treasure_run1.log
- EPOCH-58: pack integrity failed
verify:epochs:freeze FAILED
- 1 epoch(s) drifted or failed
